{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  
  "_comment_keyvault": "Key Vault configuration - secrets are loaded from Azure Key Vault in production",
  "KeyVault": {
    "VaultUri": "",
    "UseKeyVault": false,
    "UseMockKeyVault": true,
    "LocalSecretsPath": "secrets.local.json",
    "SecretPrefix": "",
    "TimeoutSeconds": 30,
    "ThrowOnUnavailable": false,
    "PreloadSecrets": [],
    "ReloadOnChange": true
  },

  "_comment_connection_strings": "Connection strings - actual values come from Key Vault or user-secrets",
  "ConnectionStrings": {
    "DefaultConnection": "<FROM_KEY_VAULT_OR_USER_SECRETS>"
  },
  "UseSqlServer": true,

  "MassTransit": {
    "RegisterConsumers": true,
    "UseAzureServiceBus": false
  },
  
  "_comment_ai": "AI Provider Configuration - Local (Ollama) or Azure OpenAI",
  "AI": {
    "Provider": "Local",
    "LLM": {
      "TimeoutMinutes": 10
    },
    "Local": {
      "OllamaUrl": "http://127.0.0.1:11434",
      "LLMModel": "qwen2.5-coder:7b",
      "EmbeddingModel": "bge-large:latest",
      "TimeoutSeconds": 120,
      "MaxRetries": 3,
      "Temperature": 0.3,
      "MaxTokens": 4096
    },
    "Azure": {
      "Endpoint": "<FROM_KEY_VAULT_OR_USER_SECRETS>",
      "ApiKey": "<FROM_KEY_VAULT_OR_USER_SECRETS>",
      "LLMDeployment": "gpt-4",
      "EmbeddingDeployment": "text-embedding-ada-002",
      "TimeoutSeconds": 120
    },
    "VectorDb": {
      "Type": "Qdrant",
      "Url": "http://localhost:6333",
      "ApiKey": "",
      "CollectionPrefix": "aar",
      "Dimension": 1024
    },
    "Rag": {
      "SmallFileThresholdBytes": 10240,
      "ChunkSizeTokens": 512,
      "ChunkOverlapPercent": 20,
      "TopK": 10,
      "MinSimilarityScore": 0.7,
      "MaxContextTokens": 8000
    }
  },
  
  "Embedding": {
    "UseMock": false
  },
  
  "Storage": {
    "BasePath": ""
  },

  "_comment_rag": "RAG processing configuration - controls file routing and memory management",
  "RagProcessing": {
    "DirectSendThresholdBytes": 10240,
    "RagChunkThresholdBytes": 204800,
    "AllowLargeFiles": false,
    "RiskTopK": 20,
    "RiskThreshold": 0.7,
    "MaxChunksPerFile": 100,
    "MaxTotalChunksPerJob": 10000,
    "UseDiskBackedChunks": true,
    "ChunkBufferKB": 64
  },

  "MemoryManagement": {
    "MaxWorkerMemoryMB": 4096,
    "MemoryWarningThresholdPercent": 80,
    "MemoryPauseThresholdPercent": 90,
    "MemoryCheckIntervalSeconds": 5,
    "MinFreeDiskSpaceMB": 1024,
    "MaxTempFolderSizeMB": 2048,
    "EnableAggressiveGC": true,
    "GCIntervalBatches": 3
  },

  "Concurrency": {
    "EmbeddingConcurrency": 4,
    "ReasoningConcurrency": 2,
    "FileReadConcurrency": 8,
    "EmbeddingBatchSize": 32,
    "ChunkProcessingConcurrency": 4
  },

  "JobApproval": {
    "WarnThresholdTokens": 500000,
    "WarnThresholdCost": 10.0,
    "ApprovalThresholdTokens": 2000000,
    "ApprovalThresholdCost": 50.0,
    "AutoRejectOverThreshold": false
  },
  
  "_comment_azure": "Azure service configuration - API keys and connection strings come from Key Vault",
  "Azure": {
    "StorageConnectionString": "<FROM_KEY_VAULT_OR_USER_SECRETS>",
    "OpenAI": {
      "Endpoint": "<FROM_KEY_VAULT_OR_USER_SECRETS>",
      "ApiKey": "<FROM_KEY_VAULT_OR_USER_SECRETS>",
      "DeploymentName": "gpt-4"
    }
  },
  
  "Cors": {
    "AllowedOrigins": [
      "http://localhost:3000",
      "https://localhost:3000"
    ]
  },
  
  "_comment_jwt": "JWT settings - secret comes from Key Vault",
  "Jwt": {
    "Secret": "<FROM_KEY_VAULT_OR_USER_SECRETS>",
    "Issuer": "AAR.Api",
    "Audience": "AAR.Clients",
    "ExpirationMinutes": 60
  },
  
  "_comment_security": "Security documentation - see docs/MIGRATION_KEYVAULT.md for setup instructions"
}
